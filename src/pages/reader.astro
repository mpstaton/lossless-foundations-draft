---
import "../styles/global.css";
import HypertextStartmatter from "@basics/HypertextStartmatter.astro";
import BaseLayout from "@layouts/BaseLayout.astro";
import HypertextEndmatter from "@basics/HypertextEndmatter.astro";
import Heading from "@components/ContentHeading.astro";
import Counter from "@components/Counter.tsx";
import { marked } from 'marked';


import { type CollectionEntry, getCollection } from "astro:content";

// export async function getStaticPaths() {
//   const allSections: CollectionEntry<"sections">[] =
//     await getCollection("sections");
//   return allSections.map((section) => ({
//     params: { slug: section.slug },
//     props: { section },
//   }));
// }

const allSections: CollectionEntry<"sections">[] =
  await getCollection("sections");

console.log(allSections);

import headingsData from "../data/headingsData.json";
---

<HypertextStartmatter />
<BaseLayout>
  <Counter client:only="react" />
  {
    headingsData.headings.map((heading) => (
      <>
        <p>hi</p>
        <Heading tagName={heading.tagName} size={heading.size}>
          {heading.text}
        </Heading>
      </>
    ))
  }
  <div class="base-reader-container">
    <!--this is where the code I need help with is. Needs to render as markdown so it can be styled properly. -->
    <ul>
      {allSections.map((section) => {
      const htmlContent = marked(section.body); 
      return (
        <li>
          <h1>{section.data.title}</h1>
          <div set:html={htmlContent} />
        </li>
      );
    })}
    </ul>
  </div>
</BaseLayout>
<HypertextEndmatter />

<style>
  h1 {
    font-size: 2em;
  }
  li {
    margin-bottom: 1rem;
  }
  p {
    font-family: var(--ff-legible);
    color: var(--clr-body);
  }

  .base-reader-container {
    margin: auto;
    padding: 1em;
    width: 94vw;
    height: 86vh;
    justify-self: start;
    border: 1px solid var(--bastille);
  }
</style>
